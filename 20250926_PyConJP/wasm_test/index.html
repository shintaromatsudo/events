<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <title>WASM 足し算サンプル</title>
</head>

<body>
    <h1>WASM 足し算サンプル</h1>

    <div>
        <label for="num1">数値1:</label>
        <input type="number" id="num1" value="1">
    </div>

    <div>
        <label for="num2">数値2:</label>
        <input type="number" id="num2" value="3">
    </div>

    <div>
        <h3>結果: <span id="result">-</span></h3>
    </div>

    <script type="module">
        import init, { add } from "./pkg/wasm_test.js";

        init().then(() => {
            calculate(); // 初回計算
        });

        window.calculate = function () {
            if (!add) return;

            const num1Input = document.getElementById('num1');
            const num2Input = document.getElementById('num2');
            const resultSpan = document.getElementById('result');

            const a = parseInt(num1Input.value) || 0;
            const b = parseInt(num2Input.value) || 0;
            const result = add(a, b);
            resultSpan.textContent = `計算結果: ${a} + ${b} = ${result}`;
        };

        // イベントリスナーを追加
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('num1').addEventListener('input', calculate);
            document.getElementById('num2').addEventListener('input', calculate);
        });
    </script>
</body>

</html>
